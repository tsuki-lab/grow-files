var b=Object.create;var x=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var $=t=>x(t,"__esModule",{value:!0});var k=(t,e,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of w(e))!P.call(t,i)&&i!=="default"&&x(t,i,{get:()=>e[i],enumerable:!(s=j(e,i))||s.enumerable});return t},p=t=>k($(x(t!=null?b(E(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var C=p(require("fs")),S=p(require("cac"));var y=p(require("path")),F=p(require("inquirer"));var c=t=>(...e)=>`[${t}m${e.join(" ")}[0m`,a={black:c("30"),red:c("31"),green:c("32"),yellow:c("33"),blue:c("34"),magenta:c("35"),cyan:c("36"),white:c("37")};var o=p(require("fs")),f=p(require("path"));var l=class{static createDir(e){let s=e.split("/").filter((i,r,n)=>r!==n.length-1).join("/");s&&o.mkdirSync(s,{recursive:!0})}static createFiles(e){e.forEach(s=>{o.writeFileSync(s.path,s.data,"utf-8"),console.info(a.green("\u2728  Create file",s.path))})}static getDirInnerContentNames(e,s){return o.readdirSync(e).filter(i=>{let r=f.join(e,i),n=o.statSync(r);switch(s){case"dir":return n.isDirectory();case"file":return n.isFile()}})}static existsContent(e){return o.existsSync(e)&&e}static getConvertData(e,s,i){return this.getDirInnerContentNames(e,"file").reduce((n,u)=>{let g=f.join(e,u),m=g.split("/"),h=m[m.length-1],D=h.indexOf("."),v=h.substring(D),N=o.readFileSync(g,"utf-8");return n.push({path:f.join(s,i+v),data:N.replace(/\$FILE_NAME/g,i)}),n},[])}};var O=async t=>{let e=l.getDirInnerContentNames(t.templatesDir,"dir");e.length<1&&(console.error(a.red("Error: Template does not exist from",t.templatesDir)),process.exit(1));let s=[{type:"list",name:"template",message:"Choose a template.",choices:e}].filter(Boolean),i=await q(t,s),r=y.join(t.templatesDir,i.template),n=l.getConvertData(r,i.outputDir,i.outputFileName);l.createDir(n[0].path);let u=n.map(m=>l.existsContent(m.path)).filter(Boolean);if(0<u.length){let D=`Error: The file already exists. Please remove ${u.filter(Boolean).join(" and ")}.`;console.error(a.red(D)),process.exit(1)}l.createFiles(n)};async function q(t,e){let s=JSON.parse(JSON.stringify(t));return await(0,F.prompt)(e).then(i=>{s.template=i.template}),s}var d=(0,S.default)();d.command("<path>","required <path>").option("-t, --templates-dir <path>","Selected templates dir",{default:`${process.env.HOME}/.grow-files/templates`}).action(async(t,e)=>{let s=t.split("/"),i=s.pop(),r={templatesDir:e.templatesDir,template:"",outputDir:s.join("/")||"/",outputFileName:i||"index"};console.info(a.cyan("Options:")),console.info(a.cyan("- templatesDir:",r.templatesDir)),I(r),console.info(a.cyan("- outputDir:",r.outputDir)),console.info(a.cyan("- outputFileName:",r.outputFileName,`
`)),await O(r)});d.help();d.version("0.2.1");d.parse();function I(t){l.existsContent(t.templatesDir)||(C.mkdirSync(t.templatesDir,{recursive:!0}),console.info(a.green(`
\u2728  Created TemplatesDir!! Let's create a template in the created directory. -`,t.templatesDir)),process.exit(0))}
